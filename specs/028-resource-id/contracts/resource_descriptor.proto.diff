// Proto Diff: ResourceDescriptor Changes
// File: proto/pulumicost/v1/costsource.proto
// Message: ResourceDescriptor (lines ~216-257)

// === BEFORE ===
message ResourceDescriptor {
  // provider identifies the cloud provider.
  // REQUIRED. Must be one of: "aws", "azure", "gcp", "kubernetes", "custom".
  // Empty or unrecognized values will result in InvalidArgument error.
  string provider = 1;

  // resource_type specifies the type of resource being described.
  // REQUIRED. Must match a resource type supported by the target plugin.
  // Maximum length: 256 characters.
  // Format: Alphanumeric with optional hyphens, colons, slashes
  // Examples: "ec2", "s3", "k8s-namespace", "aws:ec2/instance:Instance".
  // Empty values will result in InvalidArgument error.
  string resource_type = 2;

  // sku is the provider-specific SKU or instance size.
  // OPTIONAL. Required for compute resources, may be omitted for others.
  string sku = 3;

  // region specifies the deployment region.
  // OPTIONAL. Required for regional resources, omit for global resources.
  string region = 4;

  // tags provide label/tag hints for resource identification and filtering.
  // OPTIONAL. Used for additional resource matching and cost allocation.
  map<string, string> tags = 5;

  // utilization_percentage is a per-resource utilization override (0.0 to 1.0).
  // OPTIONAL. If provided, overrides the global request default.
  optional double utilization_percentage = 6;
}

// === AFTER ===
message ResourceDescriptor {
  // provider identifies the cloud provider.
  // REQUIRED. Must be one of: "aws", "azure", "gcp", "kubernetes", "custom".
  // Empty or unrecognized values will result in InvalidArgument error.
  string provider = 1;

  // resource_type specifies the type of resource being described.
  // REQUIRED. Must match a resource type supported by the target plugin.
  // Maximum length: 256 characters.
  // Format: Alphanumeric with optional hyphens, colons, slashes
  // Examples: "ec2", "s3", "k8s-namespace", "aws:ec2/instance:Instance".
  // Empty values will result in InvalidArgument error.
  string resource_type = 2;

  // sku is the provider-specific SKU or instance size.
  // OPTIONAL. Required for compute resources, may be omitted for others.
  string sku = 3;

  // region specifies the deployment region.
  // OPTIONAL. Required for regional resources, omit for global resources.
  string region = 4;

  // tags provide label/tag hints for resource identification and filtering.
  // OPTIONAL. Used for additional resource matching and cost allocation.
  map<string, string> tags = 5;

  // utilization_percentage is a per-resource utilization override (0.0 to 1.0).
  // OPTIONAL. If provided, overrides the global request default.
  optional double utilization_percentage = 6;

  // id is a client-specified identifier for request/response correlation.
  // OPTIONAL. When provided, plugins MUST include this ID in any
  // recommendations or responses related to this resource, enabling
  // clients to match responses to their original requests in batch operations.
  //
  // The ID is treated as an opaque string - plugins MUST NOT validate or
  // transform this value. Common formats include Pulumi URNs, UUIDs, or
  // application-specific identifiers.
  //
  // Example: "urn:pulumi:prod::myapp::aws:ec2/instance:Instance::webserver"
  //
  // Correlation pattern:
  //   1. Client sets id in ResourceDescriptor
  //   2. Plugin copies id to ResourceRecommendationInfo.resource_id
  //   3. Client matches response to request using id
  string id = 7;

  // arn is the canonical cloud resource identifier for exact matching.
  // OPTIONAL. When provided, plugins SHOULD use this for precise resource
  // lookup instead of matching by type/sku/region/tags.
  //
  // This field uses "arn" as the name for consistency with GetActualCostRequest,
  // but accepts canonical identifiers from any cloud provider:
  //
  // AWS ARN:
  //   arn:aws:ec2:us-east-1:123456789012:instance/i-1234567890abcdef0
  //
  // Azure Resource ID:
  //   /subscriptions/{sub-id}/resourceGroups/{rg}/providers/
  //   Microsoft.Compute/virtualMachines/{vm-name}
  //
  // GCP Full Resource Name:
  //   //compute.googleapis.com/projects/{project}/zones/{zone}/instances/{name}
  //
  // Kubernetes Resource:
  //   {cluster}/{namespace}/{kind}/{name} or UID
  //
  // Cloudflare:
  //   {zone-id}/{resource-type}/{resource-id}
  //
  // Matching behavior:
  //   - If arn is provided and valid: Use for exact resource lookup
  //   - If arn is empty or invalid: Fall back to type/sku/region/tags matching
  //   - If arn format is unrecognized: Log warning, use fallback matching
  //
  // Plugins MAY validate the arn format for their provider and SHOULD log
  // a warning if the format is invalid before falling back.
  string arn = 8;
}

// === DIFF SUMMARY ===
// Added: string id = 7 (correlation identifier)
// Added: string arn = 8 (canonical resource identifier)
// Changed: None
// Removed: None
// Breaking: No (new optional fields only)
